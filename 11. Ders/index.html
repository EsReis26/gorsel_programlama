<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <title>Document</title>
</head>
<body>
    <h1>Merhaba Stok Takip</h1>
    <h2>Kayıt Ekleme</h2>

    <form>
        <div class="mb-3">
          <label for="exampleInputEmail1" class="form-label">Ürün Adı</label>
          <input type="text" class="form-control" id="frm_urun_adi">
        </div>
        <div class="mb-3">
            <label class="form-label">Ürün Boyutu</label>
            <input type="text" class="form-control" id="frm_urun_boyutu">
        </div>
        <div class="mb-3">
            <label class="form-label">Ürün Miktarı</label>
            <input type="text" class="form-control" id="frm_urun_miktari">
        </div>
        <div class="mb-3">
            <label class="form-label">Ürün Fiyatı</label>
            <input type="text" class="form-control" id="frm_urun_fiyati">
        </div>
        <button type="submit" class="btn btn-primary" id="dgm_kayit_ekle">Submit</button>
      </form>
      <hr>
    <h2>Kayıtlar</h2>
    <table class="table table-hover">
        <thead>
            <tr>
                <th>#</th>
                <th>Ürün Adı</th>
                <th>Boyut</th>
                <th>Miktar</th>
                <th>Fiyat</th>
            </tr>
        </thead>
        <tbody id="kayit_listeleme_alani">
            
        </tbody>
    </table>
    <script src="baglanti.js"></script>
    <script>
        function kayitListeGuncelle()
        {
            var kayit_listeleme_alani = document.getElementById("kayit_listeleme_alani");
            kayit_listeleme_alani.innerHTML="";

            $sorgu = 'SELECT * FROM `urun`';

            baglanti.query($sorgu, function(hata, kayitlar, alanlar) {
                if(hata){
                    console.log("Sorgu yapılırken hata.");
                    console.log(err);
                    return;
                }

                //console.log("Sorgu başarıyla çalıştırıldı", kayitlar);
                //console.log("Sorgu başarıyla çalıştırıldı", kayitlar[0]);
                kayitlar.forEach(kayitListele);

                function kayitListele(kayit) {
                    //console.log(kayit["ad"]);
                    //console.log(kayit);
                    var satir = document.createElement("tr");
                    var sutun1 = document.createElement("td");
                    var sutun2 = document.createElement("td");
                    var sutun3 = document.createElement("td");
                    var sutun4 = document.createElement("td");
                    var sutun5 = document.createElement("td");
                    sutun1.innerHTML = kayit["id"];
                    sutun2.innerHTML = kayit["ad"];
                    sutun3.innerHTML = kayit["boyut"];
                    sutun4.innerHTML = kayit["miktar"];
                    sutun5.innerHTML = kayit["fiyat"];

                    satir.appendChild(sutun1);
                    satir.appendChild(sutun2);
                    satir.appendChild(sutun3);
                    satir.appendChild(sutun4);
                    satir.appendChild(sutun5);

                    kayit_listeleme_alani.appendChild(satir);
                }
                //console.log("Sorgu başarıyla çalıştırıldı", alanlar);
            });
        }
        kayitListeGuncelle()
    </script>

    <script>
        var dgm_kayit_ekle = document.getElementById("dgm_kayit_ekle");
        dgm_kayit_ekle.addEventListener("click", function(){
            event.preventDefault();
            let urun_adi = document.getElementById("frm_urun_adi").value;
            let urun_boyutu = document.getElementById("frm_urun_boyutu").value;
            let urun_miktari = document.getElementById("frm_urun_miktari").value;
            let urun_fiyati = document.getElementById("frm_urun_fiyati").value;
            $sorgu = "INSERT INTO `urun` (`id`, `ad`, `boyut`, `miktar`, `fiyat`)";
            $sorgu += "VALUES (NULL, '"+urun_adi+"', '"+urun_boyutu+"', '"+urun_miktari+"', '"+urun_fiyati+"');";
            baglanti.query($sorgu, function(hata) {
                if(hata){
                    console.log("Sorgu yapılırken hata.");
                    console.log(err);
                    return;
                }
                kayitListeGuncelle()
            })
        })
    </script>
</body>
</html>